# .goreleaser.yml
# -----------------------------------------------------------------------------
# GoReleaser Configuration File
# This file defines the build, archive, and release process for CLI applications.
# -----------------------------------------------------------------------------
before:
  hooks:
    # Clean up Go module dependencies to maintain a clean build environment.
    - go mod tidy

builds:
  - # pbc-gen CLI build configuration
    id: "pbc-gen"
    # Main package path for CLI application
    dir: ./cmd/pbc-gen
    # Name of the binary file to be generated
    binary: pbc-gen
    # Application entry point (main) file
    main: .
    # List of supported operating systems and architectures for build
    goos:
      - linux
      - windows
      - darwin # macOS
    goarch:
      - amd64
      - arm64
    # ldflags to apply during build
    # -s: remove symbol table, -w: remove DWARF debugging info to optimize binary size
    # -X: ë¹Œë“œ ì‹œì ì— ë²„ì „ ë° ì»¤ë°‹ ì •ë³´ë¥¼ ì£¼ì…
    ldflags:
      - -s -w
      - -X main.version={{.Version}}
      - -X main.commit={{.Commit}}
      - -X main.date={{.Date}}

archives:
  - # ìƒì„±ëœ ë°”ì´ë„ˆë¦¬ë¥¼ ì••ì¶•í•˜ëŠ” ì•„ì¹´ì´ë¸Œ ì„¤ì •
    id: "pbc-gen-archive"
    # builds ì„¤ì •ì˜ `id`ì™€ ë§¤í•‘
    builds:
      - "pbc-gen"
    # ì•„ì¹´ì´ë¸Œ íŒŒì¼ ì´ë¦„ í˜•ì‹ ì§€ì •
    name_template: >-
      {{ .ProjectName }}_
      {{- .Version }}_
      {{- .Os }}_
      {{- .Arch }}
    # ìƒì„±í•  ì•„ì¹´ì´ë¸Œ í¬ë§· (tar.gz ë° zip)
    format: binary
    # ë¦´ë¦¬ìŠ¤ì— í¬í•¨ë  ì¶”ê°€ íŒŒì¼
    files:
      - README.md
      - LICENSE

checksum:
  # ë¦´ë¦¬ìŠ¤ëœ ì•„ì¹´ì´ë¸Œì˜ ë¬´ê²°ì„±ì„ ê²€ì¦í•˜ê¸° ìœ„í•œ ì²´í¬ì„¬ íŒŒì¼ ìƒì„±
  name_template: "checksums.txt"
  # ì²´í¬ì„¬ ì•Œê³ ë¦¬ì¦˜
  algorithm: sha256

release:
  # GitHub ë¦´ë¦¬ìŠ¤ ìƒì„± ì„¤ì •
  # draft: trueë¡œ ì„¤ì •í•˜ë©´, ë¦´ë¦¬ìŠ¤ê°€ ì´ˆì•ˆ ìƒíƒœë¡œ ìƒì„±ë˜ì–´ ìˆ˜ë™ìœ¼ë¡œ ê²Œì‹œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  draft: false
  # prerelease: 'auto'ëŠ” ë²„ì „ íƒœê·¸ì— í•˜ì´í”ˆ(-)ì´ í¬í•¨ëœ ê²½ìš°(e.g., v1.0.0-beta) ì‹œí—˜íŒ ë¦´ë¦¬ìŠ¤ë¡œ í‘œì‹œí•©ë‹ˆë‹¤.
  prerelease: auto
  # ë¦´ë¦¬ìŠ¤ ë…¸íŠ¸ ì œëª© ì»¤ìŠ¤í„°ë§ˆì´ì§•
  name_template: "Release {{.Version}}"
  # ë¦´ë¦¬ìŠ¤ ë…¸íŠ¸ ìƒì„± ì„¤ì •
  footer: |
    ---
    **Full Changelog**: https://github.com/mrchypark/pocketbase-client/compare/{{ .PreviousTag }}...{{ .Tag }}

changelog:
  # ë³€ê²½ì‚¬í•­(Changelog) ìƒì„± ë°©ì‹ ì„¤ì •
  # ì»¤ë°‹ ë©”ì‹œì§€ ì œëª©ì„ ê¸°ì¤€ìœ¼ë¡œ ê·¸ë£¹í™”
  groups:
    - title: "ğŸš€ Features"
      # ì»¤ë°‹ ë©”ì‹œì§€ í”„ë¦¬í”½ìŠ¤ê°€ 'feat', 'feature'ì¸ ê²½ìš°
      regexp: '^.*?feat(\(.*\))?:'
      order: 0
    - title: "ğŸ› Bug Fixes"
      # ì»¤ë°‹ ë©”ì‹œì§€ í”„ë¦¬í”½ìŠ¤ê°€ 'fix', 'bugfix'ì¸ ê²½ìš°
      regexp: '^.*?fix(\(.*\))?:'
      order: 1
    - title: "ğŸ”§ Maintenance"
      # ì»¤ë°‹ ë©”ì‹œì§€ í”„ë¦¬í”½ìŠ¤ê°€ 'chore', 'refactor', 'style', 'test', 'docs', 'build', 'ci'ì¸ ê²½ìš°
      regexp: '^.*?(chore|refactor|style|test|docs|build|ci)(\(.*\))?:'
      order: 2
  # íŠ¹ì • ì»¤ë°‹ì„ ë³€ê²½ì‚¬í•­ì—ì„œ ì œì™¸
  filters:
    # 'Signed-off-by' ë¼ì¸ì´ í¬í•¨ëœ ì»¤ë°‹ ì œì™¸ (ì¼ë°˜ì ìœ¼ë¡œ merge ì»¤ë°‹)
    exclude:
      - '(?i)signed-off-by'
      - '^test:'
      - '^Merge '